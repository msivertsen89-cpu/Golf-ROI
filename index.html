<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Golf ROI ‚Äì Analyse & treningsforslag</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:16px;
  max-width:1000px;
  margin:auto;
}
h1 { margin-top:20px; }
.card {
  background:white;
  padding:14px;
  margin-bottom:12px;
  border-radius:8px;
}
.accordion-header {
  font-weight:bold;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
}
.accordion-content {
  display:none;
  margin-top:12px;
}
.grid {
  display:grid;
  grid-template-columns: repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
}
.field label {
  font-size:13px;
  color:#555;
}
input[type=number] {
  width:100%;
  padding:6px;
}
.good { color:green; }
.bad { color:#c62828; }
.focus { color:#ef6c00; font-weight:bold; }
.tip {
  background:#f9fbe7;
  padding:10px;
  border-radius:6px;
  margin-top:8px;
  font-size:14px;
}
button {
  padding:8px 14px;
  cursor:pointer;
}
.small { font-size:13px; color:#555; }
</style>
</head>

<body>

<h1>üèåÔ∏è Golf ROI ‚Äì Analyse & treningsforslag</h1>

<div class="card">
  <button onclick="saveBaseline()">üìå Lagre baseline</button>
  <button onclick="toggleBaseline()">üëÅÔ∏è Vis / skjul baseline</button>
  <button onclick="window.open('pdf/ukeprogram.pdf','_blank')">üìÖ Ukeprogram</button>
  <button onclick="window.open('pdf/12ukers_program.pdf','_blank')">üìà 12-ukers program</button>
  <button onclick="window.location.href='treningslogg.html'">üìù Treningslogg</button>
  <p id="baselineInfo" class="small"></p>
</div>

<div id="clubs"></div>

<script>
/* ===============================
   KONFIG
=============================== */

const STORAGE_KEY = "roi_current_v3";
const BASELINE_KEY = "roi_baseline_v3";

const CLUB_MODEL = {
  "Driver": "wood",
  "5W": "wood",
  "5i": "iron",
  "6i": "iron",
  "7i": "iron",
  "8i": "iron",
  "9i": "iron",
  "PW": "wedge",
  "50¬∞": "wedge",
  "56¬∞": "wedge",
  "60¬∞": "wedge"
};

const PGA = {
  wood:{ side:12, cons:12, smash:1.45 },
  iron:{ side:9, cons:8, smash:1.32 },
  wedge:{ side:7, cons:6, smash:1.25 }
};

/* ===============================
   STATE
=============================== */

let clubStates = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
let baselineStates = JSON.parse(localStorage.getItem(BASELINE_KEY)) || null;
let showBaseline = true;

/* ===============================
   INIT UI
=============================== */

const container = document.getElementById("clubs");

for(const club in CLUB_MODEL){
  clubStates[club] ||= {};
  container.innerHTML += `
    <div class="card">
      <div class="accordion-header" onclick="toggle('${club}')">
        ${club}
        <span id="icon-${club}">‚ñ∂</span>
      </div>

      <div class="accordion-content" id="content-${club}">
        <div class="grid">
          ${field(club,"carry","Carry (m)")}
          ${field(club,"side","Side dispersion (m)")}
          ${field(club,"cons","Length consistency (m)")}
          ${field(club,"smash","Smash factor",0.01)}
        </div>

        <div id="eval-${club}"></div>
        <div id="tip-${club}"></div>
      </div>
    </div>
  `;
  evaluateClub(club);
}

updateBaselineInfo();

/* ===============================
   FUNKSJONAR
=============================== */

function toggle(club){
  const el=document.getElementById("content-"+club);
  const icon=document.getElementById("icon-"+club);
  el.style.display = el.style.display==="block"?"none":"block";
  icon.textContent = el.style.display==="block"?"‚ñº":"‚ñ∂";
}

function field(club,key,label,step=1){
  const v=clubStates[club][key]??"";
  return `
    <div class="field">
      <label>${label}</label>
      <input type="number" step="${step}" value="${v}"
        oninput="setValue('${club}','${key}',this.value)">
    </div>`;
}

function setValue(c,k,v){
  clubStates[c][k]=v?parseFloat(v):undefined;
  localStorage.setItem(STORAGE_KEY,JSON.stringify(clubStates));
  evaluateClub(c);
}

function saveBaseline(){
  baselineStates = JSON.parse(JSON.stringify(clubStates));
  localStorage.setItem(BASELINE_KEY, JSON.stringify(baselineStates));
  updateBaselineInfo();
}

function toggleBaseline(){
  showBaseline=!showBaseline;
}

function updateBaselineInfo(){
  document.getElementById("baselineInfo").innerText =
    baselineStates ? "Baseline lagra ‚úÖ" : "Ingen baseline lagra.";
}

/* ===============================
   ANALYSE + TRENINGSFORSLAG
=============================== */

function evaluateClub(c){
  const v=clubStates[c];
  const p=PGA[CLUB_MODEL[c]];
  let good=[], bad=[], focus="", tip="";

  if(v.side!=null){
    v.side<=p.side ? good.push("God sidepresisjon") : bad.push("For stor side-spredning");
  }
  if(v.cons!=null){
    v.cons<=p.cons ? good.push("Stabil lengde") : bad.push("Ustabil lengde");
  }
  if(v.smash!=null){
    v.smash>=p.smash ? good.push("God treffkvalitet") : bad.push("Lav smash");
  }

  /* Fokus + treningsforslag */
  if(bad.includes("For stor side-spredning")){
    focus="Presisjon";
    tip=`‚Ä¢ Sl√• mot faste m√•l<br>
         ‚Ä¢ Rolig tempo<br>
         ‚Ä¢ Fokus p√• startretning`;
  }
  else if(bad.includes("Ustabil lengde")){
    focus="Lengdekontroll";
    tip=`‚Ä¢ Sl√• 3 ulike lengder<br>
         ‚Ä¢ Same tempo, ulik svinglengde<br>
         ‚Ä¢ M√•l avstand ‚Äì ikkje maks`;
  }
  else if(bad.includes("Lav smash")){
    focus="Treff";
    tip=`‚Ä¢ Treffpunkt-fokus<br>
         ‚Ä¢ Halv fart, full balanse<br>
         ‚Ä¢ Avbryt ved d√•rleg treff`;
  }
  else{
    focus="Vedlikehald";
    tip=`‚Ä¢ Behald rutinar<br>
         ‚Ä¢ Normal trening<br>
         ‚Ä¢ Ikkje overdriv justeringar`;
  }

  document.getElementById(`eval-${c}`).innerHTML = `
    <p class="good"><strong>Bra:</strong> ${good.join(", ")||"‚Äî"}</p>
    <p class="bad"><strong>D√•rleg:</strong> ${bad.join(", ")||"‚Äî"}</p>
    <p class="focus">üéØ Fokus: ${focus}</p>
  `;

  document.getElementById(`tip-${c}`).innerHTML = `
    <div class="tip">
      <strong>üõ† Treningsforslag:</strong><br>${tip}
    </div>
  `;
}
</script>

</body>
</html>
